

## T1

没啥好说的，主席树+线段树合并+经典trick


## T2

分析一下发现，事实上我们能把每个数分成四种：0/1/2/比2要大的数(下文中代称为3)

发现 0 将序列分割为了若干部分，问题转化为判定这些部分是否都存在一种合法解

而存在合法解的情况有三种：全为1，全为2，存在一个3

设 $f_{i,j,0/1,0/1,0/1}$ 即可

欸不对，还有个K不计入本质不同

我们思考下这个 k 的分配方式，考虑用唯一的构造方式与其构成双射

发现当且仅当出现010时，才会有K分配到0处，其他情况下，要么由于 11111 本身已经合法，或是 11212121 只需1的代价，或是 1212312123123 本身就拥有3，所以不需要合并

所以我们有这么一种构造方式

从左往右数，当出现 010 段时，使其变为 011

接下来数同时有12的数的段的数量即可

可以证明这样的分配方式最优

要么有两个1，要么存在3或一个2或两个相邻的2

所以可以分状态

0. 当前位置为0
1. 当前位与前一位为 01
2. 当前位置为2
3. 当前位置为2
4. 存在一个3或两个相邻的2或有两个1

接下来设 $f_{i,j,[0,4]}$ 表示第 i 位，用了 j 次，当前状态为 p 的方案数



1 12 21 212

所以可以分状态

0. 当前位置为0
1. 当前段为 1
2. 当前段为 2
3. 当前段为 12
4. 当前段为 21
5. 当前段为 212
6. 其他


最后是答案统计

需要减去一个0000000且k=1的方案