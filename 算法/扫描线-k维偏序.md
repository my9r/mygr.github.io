[[扫描线模型.pptx]]

本质是通过离线将某些询问的 side(自由度) 缩减一维


 区间判断是否可重排为 $k=1$ 的等差数列有三种方法，你知道吗？
+ 若并不保证为一个排列，则可以取平方+哈希计算等方数列 [大母神](https://www.luogu.com.cn/problem/P3792)
+ 若保证为一个排列，则可以 $max-min=r-l$ 计算
+ 若保证为一个排列，则可以计算其与数轴上相邻两项重合的部分，区间加重合部分表示相邻段的个数，根据鸽巢原理可得联通块数量，为 0 则连续

常见的搭配有:

+ 对一区间的所有子区间查询，转化为上三角矩阵查询，搭配历史线段树解决，[例](https://codeforces.com/contest/2009/problem/G3)
+ 区间操作+单点查询，换维进行扫描线，[书虫](https://www.luogu.com.cn/problem/P7560)
+ [[函数复合问题]]，搭配平衡树 
+ 最值分治转化为多个矩形的求和，[例](https://codeforces.com/contest/2009/problem/G3)

判断为空/与0取max可以考虑根据上一次被清空位置分段 [美食家](https://zhuanlan.zhihu.com/p/15860052292) 

矩阵加，矩阵求和问题，可以转化为动态二维数点问题，然后维护矩阵中数的式子的系数和求解 [# P11621 Ynoi Easy Round 2025 TEST_139](https://www.luogu.com.cn/problem/P11621)，看见矩阵求和第一时间先想着差分容斥变为 $2-side$ 问题