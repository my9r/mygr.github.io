## [[点分治]]

## LCA

来自异象石的小 Trick
对于一个点列 $a_i$ ，将其按照 $dfs$ 序排序得到 $b_i$ 
那么有 $dep_{Lca(b_l,b_{l+1}...b_r)}=\min_{i=l+1}^{r} dep_{Lca(b_i,b_{i-1})}$ 

一个点与另外一个点的 LCA 一定位于其祖先节点中，所以在 "找点对的LCA" 的问题中可以固定一个点，查看这个点的所有祖先的贡献 [[ 测试讲评&习题（二）.pdf | HDU6031，练习题第二题 ]]
## Trick

如何判断是否为 **一棵树**，同时满足无环(LCT/并查集)与点数-边数=1 

给出一个树上的点集，问该集合中所有点中的最优点，且所有点只会 **整体** 向上跳时，若任意一点作为根的子树中的点一定不优时，则可以将这部分点剔除出，剩余点跳跃是均摊 $O(n)$ 的 [# P6779  rla1rmdq](https://www.luogu.com.cn/problem/P6779)

对于树上多条路径，找其中两条使得其的交...的问题，可以考虑树链剖分，在每条链上考虑经过这条链的路径在这段上的贡献 [# Iron Man](https://www.luogu.com.cn/problem/CF704E)

遇见构造一棵树的问题，可以从 [[矩阵树定理]] 或是 [[prufer序列]] 两个角度去思考 [# CF156D Clues](https://www.luogu.com.cn/problem/CF156D)

对于保证建出树为一棵完全二叉树的问题，若要在其的基础上去跑 [[动态规划|dp]]，考虑记状态 $f_{i,j}$ 表示当前在点 $i$ ，决策的结束点在其子树的叶子 $j$ 的最优方案...  例题：[# P4253 SCOI2015 小凸玩密室](https://www.luogu.com.cn/problem/P4253)，[# P10220 省选联考 2024 迷宫守卫](https://www.luogu.com.cn/problem/P10220)

### 点边容斥

如何计算对一棵树进行染色，同种颜色点的联通块个数？可以考虑以下几个

+ 联通块个数=同颜色点的个数-两段同颜色的边数
+ 联通块个数=同颜色点的个数-父亲为同颜色点的点数

将 “联通块” 这一整体的信息转化为 “相邻点对” 这一相互独立的离散信息

例题：[[3676. 「北大集训 2021」小明的树 题解]]

## 树上路径问题

对于树上路径问题，常常有三种解决方式

1. 将树上路径转移到路径 LCA 处解决
2. 树分治转化为若干分治点解决
3. 动态规划合并子树解决(其实本质上与第一种类似)

奇奇怪怪的最优化问题，常常用 2/3 去解决

对于动态规划，若路径间无交，则考虑记 dp 状态 $f_{i,0/1/2}$ 表示当前点 $i$ ，目前的度数为 $0/1/2$ 的答案(分别代表不作为路径，有一条未完成的路径，作为路径LCA) [# 林克卡特树](https://www.luogu.com.cn/problem/P4383)
