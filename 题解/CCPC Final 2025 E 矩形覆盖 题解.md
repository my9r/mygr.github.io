
考虑扫描线+分块

对序列进行分块，每个块内维护一个区间加标记以及一个大小为 $2B$ 的数组表示处于当前位置的时间的数量