
[传送锚点](http://oj.daimayuan.top/contest/334/problem/3052)

好奇怪的名字（

据说好像是广东省集题

考虑到当一个人被炮弹干掉后，所有 $b_i$ 小于其本身的人也一定会被干掉

这也就启发我们枚举 $k$ 枚炮弹的最小值 $d$ ，最终的答案显然就是 “$b_i<d$ 的人的 $a_i$ 之和” + “所有 $d_i \ge d$ 的前 $k$ 小的 $c_i$ 之和"

此时我们可以将前面的 $a_i$ 之和所产生的贡献并入最小的 $d_i$ 当中，由于 $kq\le 5\times 10^5$ ，所以这启发我们列一个包含 $k$ 的状态转移方程，所以考虑设 $f_{i,j}$ 表示当前到 $d_i$ 的排名为 $i$ 的位置，一共添加了 $j$ 个数的最小代价之和为多少

由于带修，所以我们考虑使用线段树优化 dp，合并时，我们等价于在对两个函数 $f(x),g(x)$ 进行 Min+ 卷积，其中 $f(x)$ 代表已经选择了最小值，总共选了 $x$ 个点的最小代价，$g(x)$ 代表总共选了 $x$ 个点的最小代价

我们发现由于 $g(x)$ 是随便选的，所以一定具有凸性，而 $f(x)$ 则不确定，所以根据 [[卷积]] 相关的知识可得这可以转化为一个具有决策单调性的 dp 问题

然后我们就可以用线段树优化了




