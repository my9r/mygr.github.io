
![[d40f1025df6a11cb05688f1fe033ea45.png]]![[86cef701ae0b258585e7284dfd198550.png]]



考虑在 $n=3$ 的情况下，不同的位置加点的情况

$a_1 : 111222333444111$
$a_2 : 223334441112223$
$a_3 : 344411122233344$

对其求前缀和，发现对于一个时刻 $x$ ，将前面缺失的位置补齐，值可以表示为

$a_i+s[x+i(n+1)]$

将前缀和取反，得到 $S$

$a_i-S[x+i(n+1)]$

所以问题转化为判断两字符串相等

原来的方法之所以会炸，是因为对于每个 $x$ 我们都需要进行一次 $O(n)$ 的判断，而 $x$ 总共有 $nm$ 个



